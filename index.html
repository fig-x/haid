<!DOCTYPE html>
<html lang="en">

<head>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>A Landscape for Human-AI Decision-making</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: radial-gradient(120% 120% at 10% 10%, #e8f2ff 0%, #f1f7ff 40%, #f7f9fc 100%);
            color: #1f2430;
            line-height: 1.6;
            display: block;
            height: auto;
            overflow-x: hidden;
            overflow-y: auto;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .site-header {
            position: sticky;
            top: 0;
            z-index: 1100;
            background: rgba(255, 255, 255, 0.92);
            backdrop-filter: blur(12px);
            border-bottom: 1px solid #ece7dd;
            box-shadow: 0 6px 20px rgba(31, 37, 50, 0.04);
        }

        .nav-bar {
            max-width: 1200px;
            margin: 0 auto;
            padding: 16px 32px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 16px;
        }

        .brand {
            font-weight: 700;
            font-size: 1rem;
            letter-spacing: -0.2px;
            color: #1f4f8a;
        }

        .nav-links {
            display: flex;
            align-items: center;
            gap: 18px;
            color: #4a4f5c;
            font-size: 14px;
        }

        .nav-links a {
            border: none;
            font-weight: 600;
            color: #4a4f5c;
        }

        .nav-links a:hover {
            color: #1f4f8a;
        }

        .nav-cta {
            background: #f3f8ff;
            border: 1px solid #abcaef;
            border-radius: 999px;
            padding: 10px 20px;
            font-size: 13px;
            color: #1d336d;
            box-shadow: 0 10px 24px rgba(31, 37, 50, 0.05);
            font-weight: 700;
            text-decoration: none;
            transition: all 0.2s ease;
        }

        .nav-cta:hover {
            transform: translateY(-1px);
            box-shadow: 0 10px 24px rgba(31, 79, 138, 0.12);
        }

        .hero {
            background: transparent;
            padding: 72px 0 100px 0;
        }

        .hero-inner {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 32px;
        }

        .hero-eyebrow {
            text-transform: uppercase;
            font-size: 12px;
            letter-spacing: 1px;
            font-weight: 700;
            color: #2f6fb7;
            margin-bottom: 10px;
        }

        .hero-title {
            font-size: 2.8rem;
            color: #1b1f2a;
            margin-bottom: 20px;
            letter-spacing: -1px;
            line-height: 1.15;
        }

        .hero-authors-container {
            margin: 24px 0 28px 0;
            padding: 20px 24px;
            background: rgba(255, 255, 255, 0.6);
            backdrop-filter: blur(8px);
            border-radius: 12px;
            border: 1px solid rgba(171, 202, 239, 0.3);
            /* max-width: 900px; */
        }

        .hero-authors {
            color: #4a4f5c;
            font-size: 0.95rem;
            line-height: 1;
            margin-bottom: 0;
            font-weight: 400;
        }

        .hero-authors:not(:last-child) {
            margin-bottom: 10px;
        }

        .hero-authors strong {
            color: #1f4f8a;
            font-weight: 600;
        }

        .hero-authors:last-child {
            font-style: italic;
            color: #6b7080;
            margin-top: 4px;
        }

        .hero-copy {
            /* max-width: 760px; */
            color: #4a4f5c;
            margin-bottom: 24px;
            margin-right: 4rem;
            font-size: 1.05rem;
        }

        .hero-copy-list {
            max-width: 820px;
            color: #4a4f5c;
            font-size: 1.05rem;
            line-height: 1.65;
            margin-top: 4px;
        }

        .hero-copy-list p {
            margin: 0 0 10px 0;
            color: inherit;
            font-size: inherit;
            line-height: inherit;
            font-weight: 400;
        }

        .hero-copy-list ul {
            margin: 0;
            padding-left: 20px;
            color: inherit;
            font-size: inherit;
            line-height: inherit;
        }

        .hero-copy-list li {
            margin-bottom: 0px;
            color: inherit;
            font-weight: 400;
        }

        .section-note {
            margin-bottom: 15px;
            color: #666;
            font-size: 0.97rem;
            line-height: 1.6;
        }

        .section-note.emphasis {
            font-style: italic;
        }

        .hero-actions {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
            margin-bottom: 18px;
        }

        .btn-primary {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            background: #2f6fb7;
            color: white;
            padding: 12px 20px;
            border-radius: 999px;
            border: 1px solid #2f6fb7;
            font-weight: 700;
            font-size: 14px;
            text-decoration: none;
            transition: all 0.2s ease;
        }

        .btn-primary:hover {
            background: #1f4f8a;
            box-shadow: 0 12px 26px rgba(47, 111, 183, 0.22);
        }

        .btn-ghost {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            background: transparent;
            color: #2f6fb7;
            padding: 12px 16px;
            border-radius: 999px;
            border: 1px solid #d4e3f5;
            font-weight: 700;
            font-size: 14px;
            text-decoration: none;
            transition: all 0.2s ease;
        }

        .btn-ghost:hover {
            background: #eef5fc;
            box-shadow: 0 10px 20px rgba(47, 111, 183, 0.1);
        }

        .hero-meta {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-top: 26px;
        }

        .hero-chip {
            background: #f3f8ff;
            border: 1px solid #abcaef;
            border-radius: 999px;
            padding: 10px 20px;
            font-size: 12px;
            font-weight: 600;
            color: #4a4f5c;
            box-shadow: 0 10px 24px rgba(31, 37, 50, 0.05);
        }

        /* Fixed Left Sidebar */
        .content-grid {
            /* max-width: 90%; */
            width: calc(100% - 50px);
            margin: -40px auto 70px;
            padding: 0 24px;
            display: grid;
            grid-template-columns: minmax(300px, 380px) 1fr;
            gap: 24px;
            align-items: start;
        }

        .sidebar {
            width: 100%;
            background: #ffffff;
            border: 1px solid #ece7dd;
            box-shadow: 0 18px 50px rgba(31, 37, 50, 0.06);
            display: block;
            flex-direction: column;
            position: sticky;
            top: 110px;
            height: auto;
            z-index: 900;
            margin: 0;
            border-radius: 18px;
            overflow: scroll;
            max-height: calc(100vh - 140px);
        }

        .sidebar-header {
            padding: 24px 32px;
            border-bottom: 1px solid #f0ede6;
            background: #ffffff;
            display: flex;
            align-items: flex-start;
            justify-content: center;
            flex-direction: column;
            gap: 6px;
        }

        .sidebar-header h2 {
            font-size: 1.05rem;
            color: #1b1f2a;
            margin-bottom: 0;
            font-weight: 700;
            letter-spacing: -0.3px;
        }

        .sidebar-header p {
            color: #6b7080;
            font-size: 13px;
            font-weight: 500;
            line-height: 1.4;
        }

        .sidebar-content {
            padding: 24px 32px 32px;
            background: white;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
            gap: 18px;
            overflow: auto;
        }

        /* Color Mode Toggle Container */
        .color-mode-container {
            display: flex;
            align-items: center;
            gap: 16px;
            margin-bottom: 10px;
            padding: 10px 0px;
            /* background: #eef5fc; */
            /* border-radius: 12px; */
            /* border: 1px solid #d4e3f5; */
        }

        .color-mode-label {
            font-size: 13px;
            font-weight: 600;
            color: #495057;
            letter-spacing: 0.2px;
            margin: 0;
            white-space: nowrap;
        }

        /* Color Mode Toggle Buttons */
        .color-mode-btn-group {
            display: flex;
            gap: 8px;
            background: white;
            padding: 4px;
            border-radius: 8px;
            border: 1px solid #d4e3f5;
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
        }

        .color-mode-btn {
            padding: 10px 20px;
            border: none;
            background: transparent;
            color: #6c757d;
            cursor: pointer;
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
            border-radius: 6px;
            font-weight: 500;
            font-size: 13px;
            position: relative;
            white-space: nowrap;
        }

        .color-mode-btn:hover:not(.active) {
            background: #f8f9fa;
            color: #495057;
        }

        .color-mode-btn.active {
            background: #2f6fb7;
            color: white;
            box-shadow: 0 2px 4px rgba(47, 111, 183, 0.2);
        }

        /* Main Content Area */
        .main-content {
            flex: none;
            margin-left: 0;
            display: flex;
            flex-direction: column;
            gap: 32px;
            height: auto;
            overflow: scroll;
            max-width: 100%;
            width: 100%;
            margin: 0;
        }

        .container {
            flex: none;
            padding: 0 0 64px;
            overflow: visible;
            width: 100%;
        }

        h1 {
            text-align: left;
            color: #1b1f2a;
            font-size: 2.1rem;
            font-weight: 700;
            padding-left: 0;
            margin-bottom: 12px;
            letter-spacing: -0.6px;
            line-height: 1.25;
        }

        .page-subhead {
            font-size: 1.4rem;
            color: #1b1f2a;
            margin-bottom: 10px;
            font-weight: 700;
            letter-spacing: -0.3px;
        }

        .intro-text {
            border-radius: 12px;
            padding: 18px 20px 26px 20px;
            line-height: 1.65;
            color: #4a4f5c;
            background: #ffffff;
            border: 1px solid #ece7dd;
            box-shadow: 0 10px 24px rgba(31, 37, 50, 0.05);
        }

        .intro-text h2 {
            color: #1b1f2a;
            margin-bottom: 16px;
            font-size: 1.4rem;
            font-weight: 600;
            letter-spacing: -0.3px;
        }

    
        .intro-text ul {
            margin-left: 20px;
        }


        .section {
            background: white;
            border-radius: 16px;
            margin-bottom: 32px;
            padding: 28px;
            border: 1px solid #ece7dd;
            box-shadow: 0 16px 36px rgba(31, 37, 50, 0.06);
        }

        .section-title {
            font-size: 1.5rem;
            color: #1b1f2a;
            margin-bottom: 28px;
            border-bottom: 2px solid #ece7dd;
            padding-bottom: 16px;
            font-weight: 600;
            letter-spacing: -0.4px;
        }

        /* Scatterplot Styles */
        #scatterplot {
            width: 100%;
            height: 500px;
            border: 1px solid #ece7dd;
            border-radius: 14px;
            position: relative;
            background: #ffffff;
        }

        .tooltip {
            position: absolute;
            padding: 12px 16px;
            background: rgba(33, 37, 41, 0.95);
            color: white;
            border-radius: 6px;
            pointer-events: none;
            font-size: 13px;
            max-width: 300px;
            z-index: 1000;
            opacity: 0;
            transition: opacity 0.2s;
            line-height: 1.5;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            backdrop-filter: blur(8px);
        }

        .legend {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-top: 15px;
            justify-content: center;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 12px;
        }

        .legend-color {
            width: 12px;
            height: 12px;
            border-radius: 50%;
        }

        /* Tag-style multi-select filters */
        .tag-container {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 8px;
        }

        .filter-tag {
            padding: 6px 14px;
            border-radius: 6px;
            border: 1.5px solid #d4e3f5;
            background-color: #eef5fc;
            font-size: 12px;
            font-weight: 500;
            cursor: pointer;
            color: #1f4f8a;
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
            max-width: 100%;
            white-space: nowrap;
            text-overflow: ellipsis;
            overflow: hidden;
        }

        .filter-tag:hover {
            background-color: #e0ecfb;
            border-color: #c5d9f3;
            transform: translateY(-1px);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
        }

        .filter-tag.selected {
            background: #2f6fb7;
            color: #fff;
            border-color: #2f6fb7;
            box-shadow: 0 2px 6px rgba(47, 111, 183, 0.22);
        }

        /* Sidebar Filter Controls */
        .filter-group {
            margin-bottom: 28px;
        }

        .filter-group label {
            font-weight: 600;
            margin-bottom: 12px;
            color: #1b1f2a;
            display: block;
            font-size: 13px;
            letter-spacing: 0;
        }

        .filter-group select,
        .filter-group input {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
        }

        .search-box {
            margin-bottom: 24px;
            grid-column: 1 / -1;
        }

        .search-box input {
            width: 100%;
            padding: 14px 16px;
            font-size: 14px;
            border: 1.5px solid #d4e3f5;
            border-radius: 10px;
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
            background: white;
        }

        .search-box input:focus {
            outline: none;
            border-color: #2f6fb7;
            box-shadow: 0 0 0 3px rgba(47, 111, 183, 0.12);
        }

        .search-box input::placeholder {
            color: #adb5bd;
        }

        /* Citation Range Slider Styles */
        .range-slider-container {
            padding: 20px 16px;
            background: #eef5fc;
            border-radius: 10px;
            border: 1px solid #d4e3f5;
        }

        .range-inputs {
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
        }

        .range-input-wrapper {
            flex: 1;
        }

        .range-input-wrapper label {
            font-size: 11px;
            color: #666;
            display: block;
            margin-bottom: 3px;
        }

        .range-input-wrapper input[type="number"] {
            width: 100%;
            padding: 8px 12px;
            font-size: 13px;
            border: 1.5px solid #d4e3f5;
            border-radius: 6px;
            transition: all 0.2s;
            background: white;
        }

        .range-input-wrapper input[type="number"]:focus {
            outline: none;
            border-color: #2f6fb7;
            box-shadow: 0 0 0 3px rgba(47, 111, 183, 0.12);
        }

        input[type="range"] {
            width: 100%;
            height: 4px;
            background: #e5e5e5;
            outline: none;
            border-radius: 0;
            -webkit-appearance: none;
        }

        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            -moz-appearance: none;
            width: 18px;
            height: 18px;
            background: #2f6fb7;
            cursor: pointer;
            border-radius: 50%;
            transition: all 0.2s;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        input[type="range"]::-webkit-slider-thumb:hover {
            background: #1f4f8a;
            transform: scale(1.1);
        }

        input[type="range"]::-moz-range-thumb {
            width: 18px;
            height: 18px;
            background: #2f6fb7;
            cursor: pointer;
            border-radius: 50%;
            border: none;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        /* Column Visibility Controls */
        .column-controls {
            margin-bottom: 10px;
            padding: 20px;
            background: #eef5fc;
            border-radius: 12px;
            border: 1px solid #d4e3f5;
            grid-column: 1 / -1;
        }

        .column-controls h4 {
            margin-bottom: 14px;
            color: #1b1f2a;
            font-size: 0.9rem;
            font-weight: 600;
            letter-spacing: 0;
        }

        .column-checkboxes {
            display: flex;
            flex-direction: column;
            gap: 0px;
        }

        .checkbox-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 6px 0;
            transition: background-color 0.2s;
            padding-left: 8px;
            margin-left: -8px;
        }

        .checkbox-item:hover {
            background-color: #f5f5f5;
        }

        .checkbox-item input[type="checkbox"] {
            margin: 0;
            width: 16px;
            height: 16px;
            cursor: pointer;
            accent-color: #2f6fb7;
        }

        .checkbox-item label {
            font-size: 13px;
            cursor: pointer;
            flex: 1;
            color: #666;
            font-weight: 400;
        }

        /* Table Styles */
        .table-container {
            overflow-x: auto;
            overflow-y: visible;
            margin-bottom: 20px;
            -webkit-overflow-scrolling: touch;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 14px;
            table-layout: auto;
        }

        th,
        td {
            padding: 14px 16px;
            text-align: left;
            border-bottom: 1px solid #ece7dd;
            overflow: hidden;
            text-overflow: ellipsis;
            vertical-align: top;
        }

        /* Column-specific widths */
        th.id-cell,
        td.id-cell {
            width: 75px;
            min-width: 75px;
            max-width: 75px;
            font-size: 10px;
            text-align: left;
        }

        th.title-cell,
        td.title-cell {
            width: 280px;
            min-width: 200px;
            max-width: 350px;
            white-space: normal;
            line-height: 1.4;
        }

        th.abstract-cell,
        td.abstract-cell {
            white-space: normal;
            line-height: 1.5;
        }


        th.author-cell,
        td.author-cell {
            width: 350px;
            min-width: 300px;
            max-width: 400px;
            white-space: normal;
            line-height: 1.5;
        }

        th.year-cell,
        td.year-cell {
            width: 75px;
            min-width: 75px;
            max-width: 75px;
            text-align: center;
        }

        th.link-cell,
        td.link-cell {
            width: 50px;
            min-width: 50px;
            max-width: 50px;
            text-align: left;
        }

        th.venue-cell,
        td.venue-cell {
            width: 175px;
            min-width: 175px;
            max-width: 175px;
            text-align: center;
        }

        th.authors-cell,
        th.abstract-cell,
        td.authors-cell,
        td.abstract-cell {
            white-space: normal;
            line-height: 1.5;
        }

        /* Wrapper div inside authors cell for scrolling */
        .authors-wrapper,
        .abstract-wrapper {
            max-height: 120px;
            overflow-y: auto;
            overflow-x: hidden;
            word-wrap: break-word;
        }

        /* Custom scrollbar for authors wrapper */
        .authors-wrapper::-webkit-scrollbar,
        .abstract-wrapper::-webkit-scrollbar {
            width: 8px;
        }

        .authors-wrapper::-webkit-scrollbar-track,
        .abstract-wrapper::-webkit-scrollbar-track {
            background: transparent;
        }

        .authors-wrapper::-webkit-scrollbar-thumb,
        .abstract-wrapper::-webkit-scrollbar-thumb {
            background: rgba(173, 181, 189, 0.3);
            border-radius: 4px;
            transition: background 0.2s ease;
        }

        .authors-wrapper::-webkit-scrollbar-thumb:hover,
        .abstract-wrapper::-webkit-scrollbar-thumb:hover {
            background: rgba(173, 181, 189, 0.6);
        }

        /* Firefox scrollbar styling */
        .authors-wrapper,
        .abstract-wrapper {
            scrollbar-width: thin;
            scrollbar-color: rgba(173, 181, 189, 0.3) transparent;
        }

        .authors-wrapper:hover,
        .abstract-wrapper:hover {
            scrollbar-color: rgba(173, 181, 189, 0.5) transparent;
        }

        th.table-label-cell,
        td.table-label-cell {
            width: 180px;
            min-width: 140px;
            max-width: 250px;
            white-space: normal;
            
        }

        /* Other columns default widths */
        th:not(.id-cell):not(.title-cell):not(.abstract-cell):not(.year-cell):not(.authors-cell):not(.table-label-cell),
        td:not(.id-cell):not(.title-cell):not(.abstract-cell):not(.year-cell):not(.authors-cell):not(.table-label-cell) {
            width: auto;
            min-width: 100px;
            max-width: 200px;
            white-space: normal;
        }

        tr {
            transition: background-color 0.15s;
        }

        tr:hover {
            background-color: #f3f8ff;
        }

        th {
            background: #ffffff;
            font-weight: 600;
            position: sticky;
            top: 0;
            z-index: 10;
            cursor: pointer;
            user-select: none;
            transition: all 0.2s;
            color: #1f4f8a;
            font-size: 14px;
            letter-spacing: 0;
            text-transform: none;
        }

        th:hover {
            background: #f5f7fa;
        }

        th.sortable::after {
            content: ' ↕';
            opacity: 0.5;
            font-size: 10px;
        }

        th.sort-asc::after {
            content: ' ↑';
            opacity: 1;
            color: #2f6fb7;
        }

        th.sort-desc::after {
            content: ' ↓';
            opacity: 1;
            color: #2f6fb7;
        }


        .bibtex-cell {
            white-space: pre-wrap;
            font-family: monospace;
            font-size: 11px;
            max-width: 300px;
            line-height: 1.4;
        }

        .lowercase-cell {
            text-transform: lowercase;
        }

        .uppercase-cell {
            text-transform: uppercase;
        }

        /* Table cell labels for multi-value columns */
        .table-label-cell {
            /* padding: 8px 14px; */
            white-space: normal;
            line-height: 1.8;
        }

        .table-label {
            display: inline-block;
            padding: 4px 10px;
            margin: 3px 5px 3px 0;
            background: #eef5fc;
            border: 1px solid #d4e3f5;
            border-radius: 5px;
            font-size: 12px;
            font-weight: 500;
            color: #1f4f8a;
            white-space: nowrap;
        }

        .highlighted-row {
            background: #f3f8ff !important;
            border-left: 3px solid #6898ce;
        }

        .highlighted-dot {
            stroke: #000 !important;
            stroke-width: 2px !important;
            r: 6 !important;
        }

        .show-more-btn {
            display: block;
            margin: 32px auto;
            padding: 14px 32px;
            background: #2f6fb7;
            color: white;
            border: 1.5px solid #2f6fb7;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
            letter-spacing: 0;
            box-shadow: 0 10px 20px rgba(47, 111, 183, 0.18);
        }

        .show-more-btn:hover {
            background: #1f4f8a;
            border-color: #1f4f8a;
            transform: translateY(-1px);
            box-shadow: 0 12px 24px rgba(47, 111, 183, 0.22);
        }

        .show-more-btn:active {
            transform: translateY(0);
        }

        .show-more-btn:disabled {
            background: #e9ecef;
            color: #adb5bd;
            border-color: #e9ecef;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .loading {
            text-align: center;
            padding: 20px;
            color: #666;
        }

        .stats {
            text-align: center;
            margin-bottom: 24px;
            color: #4a4f5c;
            font-weight: 500;
            font-size: 14px;
            padding: 14px 16px;
            background: #eef5fc;
            border-radius: 12px;
            border: 1px solid #d4e3f5;
        }

        a {
            color: #2f6fb7;
            text-decoration: none;
            font-weight: 500;
            transition: color 0.2s;
            border-bottom: 1px solid #c5d9f3;
        }

        a:hover {
            color: #1f4f8a;
            border-bottom-color: #1f4f8a;
        }

        /* Link icon styling in table cells */
        td a[title="Open link"] {
            border-bottom: none;
            color: #2f6fb7;
            transition: all 0.2s ease;
        }

        td a[title="Open link"]:hover {
            color: #1f4f8a;
            transform: scale(1.1);
        }

        .link-icon {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 24px;
            height: 24px;
            text-decoration: none;
        }

        td a[title="Open link"] svg {
            display: block;
        }

        /* Mobile Responsiveness */
        @media (max-width: 768px) {
            .nav-bar {
                padding: 14px 18px;
                flex-wrap: wrap;
                gap: 10px;
            }

            .nav-links {
                width: 100%;
                gap: 12px;
                flex-wrap: wrap;
            }

            .hero {
                padding: 48px 0 80px;
            }

            .hero-inner {
                padding: 0 18px;
            }

            .hero-title {
                font-size: 2.1rem;
            }

            .content-grid {
                grid-template-columns: 1fr;
                margin: -24px auto 36px;
                padding: 0 18px;
            }

            .sidebar {
                width: 100%;
                margin: 0;
                position: relative;
                top: 0;
                max-height: none;
            }

            .sidebar-content {
                grid-template-columns: 1fr;
                overflow: visible;
            }

            .main-content {
                width: 100%;
                margin: 0;
                height: auto;
                overflow: visible;
            }

            .container {
                padding: 0 0 40px;
                overflow: visible;
            }

            h1 {
                font-size: 2rem;
            }

            #scatterplot {
                height: 320px;
            }

            th,
            td {
                padding: 8px 10px;
                font-size: 12px;
            }
        }

        /* Scrollbar styling for sidebar */
        .sidebar-content::-webkit-scrollbar {
            width: 8px;
        }

        .sidebar-content::-webkit-scrollbar-track {
            background: #f8f9fa;
        }

        .sidebar-content::-webkit-scrollbar-thumb {
            background: #ced4da;
            border-radius: 4px;
        }

        .sidebar-content::-webkit-scrollbar-thumb:hover {
            background: #adb5bd;
        }

        /* Custom scrollbar for main content */
        .container::-webkit-scrollbar {
            width: 10px;
        }

        .container::-webkit-scrollbar-track {
            background: #f8f9fa;
        }

        .container::-webkit-scrollbar-thumb {
            background: #ced4da;
            border-radius: 5px;
        }

        .container::-webkit-scrollbar-thumb:hover {
            background: #adb5bd;
        }
    </style>
</head>

<body>
    <!-- <header class="site-header">
        <div class="nav-bar">
            <div class="nav-links">
                <a href="#scatterplot">Visualization</a>
                <a href="#papersTable">Corpus</a>
                <a href="#columnCheckboxes">Columns</a>
            </div>
           
        </div>
    </header> -->

    <section class="hero">
        <div class="hero-inner">
            <h1 class="hero-title">Mapping Out the Landscape of Human–AI Decision-Making Through a Systematic Review</h1>
            <div class="hero-authors-container">
                <p class="hero-authors"><strong>Authors:</strong> Yixin Bai, Taehyun Yang, Zhongzheng Xu, Dayeon Ki, Ziyi Wang, Yu Hou, Fumeng Yang</p>
                <p class="hero-authors"><strong>Affiliation:</strong> University of Maryland, College Park</p>
                <p class="hero-authors">Unpublished manuscript</p>
            </div>
            <p class="hero-copy">Research on human–AI decision-making (HAID) has grown rapidly across domains, yet the literature remains fragmented with conceptual ambiguities hindering systematic synthesis. We present a systematic review of HAID publications from 2016 to 2024, analyzing 1,493 articles from 20 publishers and databases. Our work contributes: (1) a systematic categorization including 6 contribution types, 13 domains of application, and 4 decision levels; (2) taxonomies of 8 AI roles and 6 human roles, their inputs to decision-making, and their influences on each other; and (3) the identification of 4 research gaps and pathways forward. This interactive interface provides access to our complete corpus, enabling exploration through semantic visualization, filtering, and search capabilities.</p>
            <!-- <div class="hero-actions">
                <a class="btn-primary" href="#papersTable">View the corpus</a>
                <a class="btn-ghost" href="#scatterplot">Open t-SNE map</a>
                <a class="btn-ghost" href="final_papers.csv" download>Download data</a>
            </div> -->
<!-- 
            <div class="hero-copy-list">
                <ul>
                <li><strong>t-SNE visualization:</strong> Explore semantic clusters; click points to highlight matching table rows.</li>
                <li><strong>Interactive filtering:</strong> Focus by database, year, domain, contribution type, and human/AI roles.</li>
                <li><strong>Sortable table:</strong> Sort any column and toggle visibility to customize your view.</li>
                <li><strong>Search:</strong> Find papers quickly across titles, abstracts, and authors.</li>
            </ul>
        </div> -->

            <div class="hero-meta">
                <a class="nav-cta" href="final_papers.csv" download>Download CSV</a>
                <a class="nav-cta" target="_blank" href="final_papers.csv" download>Manuscript</a>
                <a class="nav-cta" target="_blank" href="https://doi.org/10.17605/OSF.IO/U5QJH" download>Code</a>
                <a class="nav-cta" href="#" id="bibtexCopyBtn">Bibtex</a>
                <!-- <span class="hero-chip">Filters + interactive map</span> -->
                <!-- <span class="hero-chip">Filters + interactive map</span> -->
            </div>

        </div>
    </section>

    <div class="content-grid">
    <!-- Filters & controls -->
    <div class="sidebar">
        <div class="sidebar-header">
            <h2>Filters & Controls</h2>
            <p>Use filters to explore the literature corpus</p>
        </div>

        <div class="sidebar-content">
            <!-- Search Box -->
            <div class="search-box">
                <input type="text" id="searchInput" placeholder="Search titles, abstracts, or authors...">
            </div>

            <!-- Filter Controls -->
            <div class="filter-group">
                <label for="databaseFilter">Database</label>
                <div id="databaseFilter" class="tag-container"></div>
            </div>

            <div class="filter-group">
                <label for="yearFilter">Year</label>
                <div id="yearFilter" class="tag-container"></div>
            </div>

            <div class="filter-group">
                <label for="contributiontypesFilter">Contribution Types</label>
                <div id="contributiontypesFilter" class="tag-container"></div>
            </div>

            <div class="filter-group">
                <label for="applicationdomainsFilter">Application Domains</label>
                <div id="applicationdomainsFilter" class="tag-container"></div>
            </div>


            <div class="filter-group">
                <label for="decisiontypesFilter">Decision Types</label>
                <div id="decisiontypesFilter" class="tag-container"></div>
            </div>



            <div class="filter-group">
                <label for="airolesFilter">AI Roles</label>
                <div id="airolesFilter" class="tag-container"></div>
            </div>

            <div class="filter-group">
                <label for="humanrolesFilter">Human Roles</label>
                <div id="humanrolesFilter" class="tag-container"></div>
            </div>

            <div class="filter-group">
                <label for="humaninfluenceFilter">Human Influence</label>
                <div id="humaninfluenceFilter" class="tag-container"></div>
            </div>

            <div class="filter-group">
                <label for="aiinfluenceFilter">AI Influence</label>
                <div id="aiinfluenceFilter" class="tag-container"></div>
            </div>

            <div class="filter-group">
                <label for="modalityFilter">Modality</label>
                <div id="modalityFilter" class="tag-container"></div>
            </div>

            <div class="filter-group">
                <label for="codefullpaperFilter">Full-text Paper</label>
                <div id="codefullpaperFilter" class="tag-container"></div>
            </div>

            <!-- Citation Range Slider -->
            <div class="filter-group">
                <label>Citation Range</label>
                <div class="range-slider-container">
                    <div class="range-inputs">
                        <div class="range-input-wrapper">
                            <label for="citationMinInput">Min</label>
                            <input type="number" id="citationMinInput" min="0" value="0">
                        </div>
                        <div class="range-input-wrapper">
                            <label for="citationMaxInput">Max</label>
                            <input type="number" id="citationMaxInput" min="0" value="1000">
                        </div>
                    </div>
                    <input type="range" id="citationMinSlider" min="0" max="1000" value="0" step="1">
                    <input type="range" id="citationMaxSlider" min="0" max="1000" value="1000" step="1">
                </div>
            </div>

            <!-- Column Visibility Controls -->
            <div class="column-controls">
                <h4>Show/Hide Columns</h4>
                <div class="column-checkboxes" id="columnCheckboxes"></div>
            </div>
        </div>
    </div>

    <!-- Main Content Area -->
    <div class="main-content">

            <!-- Scatterplot Section -->
            <div class="section">
                <h2 class="section-title">t-SNE Visualization</h2>
                <p class="section-note">
                    This visualization shows papers clustered by semantic similarity. Papers that are close together
                    share similar concepts. Click on any paper in the table below will highlight the corresponding point
                    in the visualization.
                    <b>Note: it might take a few moments to load the dataset.</b>
                </p>
                <!-- Color Mode Toggle -->
                <div class="color-mode-container">
                    <label class="color-mode-label">Color By:</label>
                    <div class="color-mode-btn-group">
                        <button class="color-mode-btn active" data-mode="cluster">Cluster</button>
                        <!-- <button class="color-mode-btn" data-mode="fullpaper">Full-text</button> -->
                        <button class="color-mode-btn" data-mode="citation">Citation</button>
                    </div>
                </div>

                <div id="scatterplot"></div>
                <div class="legend" id="legend"></div>
                <div class="tooltip" id="tooltip"></div>
            </div>

            <!-- Table Section -->
            <div class="section">
                <h2 class="section-title">Papers Corpus</h2>
                <p class="section-note emphasis">
                    Browse and filter the complete collection of papers. Click on column headers to sort, use the
                    filters to narrow your search, and click on any row to highlight it in the visualization above.
                </p>

                <div class="stats" id="tableStats"></div>

                <div class="table-container">
                    <table id="papersTable">
                        <thead id="tableHead"></thead>
                        <tbody id="tableBody"></tbody>
                    </table>
                </div>

                <button class="show-more-btn" id="showMoreBtn">Show More Papers</button>
            </div>
        </div>
    </div>

    <script>
        // Global variables
        let papersData = [];
        let embeddingData = [];
        let filteredData = [];
        let displayedRows = 20;
        let currentHighlightedId = null;
        let currentSort = { column: null, direction: 'asc' };
        let currentColorMode = 'cluster';
        let citationRange = { min: 0, max: 3000 };
        let maxCitations = 3000;

        // Database name capitalization mapping
        // Maps lowercase/incorrect capitalization to proper capitalization
        const databaseCapitalizationMap = {
            'acm': 'ACM',
            'ieee': 'IEEE',
            'springernature': 'Springer Nature',
            'elsevier': 'Elsevier',
            'acl': 'ACL',
            'aaai': 'AAAI',
            'acs': 'ACS',
            'aisel': 'AISel',
            'ama': 'AMA',
            'apa': 'APA',
            'iclr': 'ICLR',
            'neurips': 'NeurIPS',
            'ijcai': 'IJCAI',
            'jstor': "JSTOR",
            'mlr': 'MLR',
            'pmlr': 'PMLR',
            'sage': 'SAGE',
            'science': "Science",
            'taylor-and-francis': 'Taylor & Francis',
            'wiley': 'Wiley'
        };

        // Helper function to get properly capitalized database name
        function getCapitalizedDatabaseName(value) {
            const lowerValue = value.toLowerCase().trim();
            return databaseCapitalizationMap[lowerValue] || value;
        }

        // Color scheme for clusters
        const clusterColors = ['#58b3e8', '#edca2b', '#82b849', '#b69fed'];

        // Color schemes for other modes
        const fullPaperColors = {
            'yes': '#03a648',
            'no': '#cccccc'
        };

        // Default visible columns
        const defaultColumns = ['Title', 'Abstract', 'Year', 'Authors', 'Venue', 'Link', 'Citation'];
        let visibleColumns = [...defaultColumns];

        // All available columns
        const allColumns = [ //'Human Input',  'AI Input',
            'Database', 'Title', 'Abstract', 'Code Full Paper', 'ID',
            'DOI', 'Authors', 'Venue', 'Year', 'Bibtex', 'Link',
            'Human Influence',
            'AI Influence', 'Modality', 'AI Roles',
            'Human Roles', 'Application Domains', 'Contribution Types', 'Decision Types', 'Citation'
        ];

        // Initialize the application
        async function init() {
            try {
                await loadData();
                setupCitationSlider();
                setupColumnControls();
                setupFilters();
                setupEventListeners();
                createScatterplot();
                updateTable();
            } catch (error) {
                console.error('Error initializing application:', error);
                document.getElementById('tableBody').innerHTML =
                    '<tr><td colspan="100%">Error loading data. Please ensure final_coding_results.csv and final_paper_dr.csv are in the same directory.</td></tr>';
            }
        }

        // Load CSV data
        async function loadData() {
            try {
                // Load papers data
                const papersResponse = await fetch('final_papers.csv');
                const papersText = await papersResponse.text();
                papersData = parseCSV(papersText);

                // Load embedding data
                const embeddingResponse = await fetch('final_paper_dr.csv');
                const embeddingText = await embeddingResponse.text();
                embeddingData = parseCSV(embeddingText);

                // Merge data
                mergeData();
                filteredData = [...papersData];

                console.log(`Loaded ${papersData.length} papers and ${embeddingData.length} embeddings`);
            } catch (error) {
                console.error('Error loading data:', error);
                throw error;
            }
        }

        // Robust CSV parser that handles multiline cells and various edge cases
        function parseCSV(text) {
            if (!text || typeof text !== 'string') return [];

            const result = [];
            let current = '';
            let inQuotes = false;
            let row = [];
            let headers = null;

            for (let i = 0; i < text.length; i++) {
                const char = text[i];
                const nextChar = text[i + 1];

                if (char === '"') {
                    if (inQuotes && nextChar === '"') {
                        current += '"';
                        i++;
                    } else {
                        inQuotes = !inQuotes;
                    }
                } else if (char === ',' && !inQuotes) {
                    row.push(current.trim());
                    current = '';
                } else if ((char === '\n' || char === '\r') && !inQuotes) {
                    if (current || row.length > 0) {
                        row.push(current.trim());

                        if (!headers) {
                            headers = row.map(h => h.replace(/^"|"$/g, ''));
                        } else if (row.length === headers.length && row.some(cell => cell.trim())) {
                            const rowObject = {};
                            headers.forEach((header, index) => {
                                rowObject[header] = row[index] ? row[index].replace(/^"|"$/g, '') : '';
                            });
                            result.push(rowObject);
                        }

                        row = [];
                        current = '';
                    }

                    if (char === '\r' && nextChar === '\n') {
                        i++;
                    }
                } else {
                    current += char;
                }
            }

            if (current || row.length > 0) {
                row.push(current.trim());
                if (headers && row.length === headers.length && row.some(cell => cell.trim())) {
                    const rowObject = {};
                    headers.forEach((header, index) => {
                        rowObject[header] = row[index] ? row[index].replace(/^"|"$/g, '') : '';
                    });
                    result.push(rowObject);
                }
            }

            return result;
        }

        // Merge papers and embedding data
        function mergeData() {
            const embeddingMap = new Map();
            embeddingData.forEach(row => {
                embeddingMap.set(row.id, row);
            });

            papersData.forEach(paper => {
                const embedding = embeddingMap.get(paper.id);
                if (embedding) {
                    paper.tsne_x = parseFloat(embedding.tsne_x);
                    paper.tsne_y = parseFloat(embedding.tsne_y);
                    paper.cluster = parseInt(embedding.cluster);
                }

                paper.Citation = parseInt(paper.Citation) || 0;
            });

            // Calculate max citations for slider
            maxCitations = Math.max(...papersData.map(p => p.Citation), 3000);
        }

        // Setup citation range slider
        function setupCitationSlider() {
            const minSlider = document.getElementById('citationMinSlider');
            const maxSlider = document.getElementById('citationMaxSlider');
            const minInput = document.getElementById('citationMinInput');
            const maxInput = document.getElementById('citationMaxInput');

            // Set max values
            minSlider.max = maxCitations;
            maxSlider.max = maxCitations;
            minInput.max = maxCitations;
            maxInput.max = maxCitations;
            maxSlider.value = maxCitations;
            maxInput.value = maxCitations;

            citationRange.max = maxCitations;

            // Min slider change
            minSlider.addEventListener('input', (e) => {
                const value = parseInt(e.target.value);
                if (value <= citationRange.max) {
                    citationRange.min = value;
                    minInput.value = value;
                    applyFilters();
                }
            });

            // Max slider change
            maxSlider.addEventListener('input', (e) => {
                const value = parseInt(e.target.value);
                if (value >= citationRange.min) {
                    citationRange.max = value;
                    maxInput.value = value;
                    applyFilters();
                }
            });

            // Min input change
            minInput.addEventListener('change', (e) => {
                let value = parseInt(e.target.value) || 0;
                value = Math.max(0, Math.min(value, citationRange.max));
                citationRange.min = value;
                minSlider.value = value;
                minInput.value = value;
                applyFilters();
            });

            // Max input change
            maxInput.addEventListener('change', (e) => {
                let value = parseInt(e.target.value) || maxCitations;
                value = Math.max(citationRange.min, Math.min(value, maxCitations));
                citationRange.max = value;
                maxSlider.value = value;
                maxInput.value = value;
                applyFilters();
            });
        }

        // Setup column visibility controls
        function setupColumnControls() {
            const container = document.getElementById('columnCheckboxes');
            allColumns.forEach(column => {
                const item = document.createElement('div');
                item.className = 'checkbox-item';

                const checkbox = document.createElement('input');
                checkbox.type = 'checkbox';
                checkbox.id = `col_${column}`;
                checkbox.checked = visibleColumns.includes(column);
                checkbox.addEventListener('change', () => {
                    let newlyAddedColumn = null;
                    if (checkbox.checked) {
                        if (!visibleColumns.includes(column)) {
                            visibleColumns.push(column);
                            newlyAddedColumn = column; // Track the newly added column
                        }
                    } else {
                        visibleColumns = visibleColumns.filter(col => col !== column);
                    }
                    updateTable(newlyAddedColumn); // Pass the newly added column
                });

                const label = document.createElement('label');
                label.htmlFor = `col_${column}`;
                label.textContent = column;

                item.appendChild(checkbox);
                item.appendChild(label);
                container.appendChild(item);
            });
        }

        // Setup tag-based multi-select filters
        function setupFilters() {
            const filterColumns = [//'Human Input','AI Input',
                'Human Influence', 'AI Influence', 'Decision Types',
                'Modality', 'AI Roles', 'Human Roles', 'Application Domains', 'Contribution Types', 'Database', 'Code Full Paper', 'Year'
            ];

            filterColumns.forEach(column => {
                const values = new Set();
                papersData.forEach(paper => {
                    if (paper[column]) {
                        const parts = paper[column].split(',').map(p => p.trim()).filter(p => p);
                        parts.forEach(part => values.add(part));
                    }
                });

                const filterId = column.toLowerCase().replace(/[^a-z]/g, '') + 'Filter';
                const container = document.getElementById(filterId);

                const arrayValues = Array.from(values).filter(v => v && v !== 'NA');

                if (container) {
                    arrayValues.sort().forEach(value => {
                        const tag = document.createElement('button');
                        tag.type = 'button';
                        tag.className = 'filter-tag';

                        // For Database column, use capitalized display name but keep original value for filtering
                        if (column === 'Database') {
                            tag.textContent = getCapitalizedDatabaseName(value);
                            tag.dataset.value = value; // Keep original value for filtering
                        } else {
                            tag.textContent = value;
                            tag.dataset.value = value;
                        }

                        tag.addEventListener('click', () => {
                            tag.classList.toggle('selected');
                            applyFilters();
                        });
                        container.appendChild(tag);
                    });
                }
            });
        }

        // Setup event listeners
        function setupEventListeners() {
            // Search input with debounce
            let searchTimeout;
            document.getElementById('searchInput').addEventListener('input', (e) => {
                clearTimeout(searchTimeout);
                searchTimeout = setTimeout(() => {
                    applyFilters();
                }, 300);
            });

            // Show more button
            document.getElementById('showMoreBtn').addEventListener('click', () => {
                displayedRows += 50;
                updateTable();
            });

            // Color mode toggle buttons
            const colorModeButtons = document.querySelectorAll('.color-mode-btn');
            colorModeButtons.forEach(button => {
                button.addEventListener('click', () => {
                    colorModeButtons.forEach(btn => btn.classList.remove('active'));
                    button.classList.add('active');

                    currentColorMode = button.dataset.mode;
                    updateScatterplotColors();
                    updateLegend();
                });
            });
        }

        // Sorting functionality
        function sortData(column) {
            if (currentSort.column === column) {
                currentSort.direction = currentSort.direction === 'asc' ? 'desc' : 'asc';
            } else {
                currentSort.column = column;
                currentSort.direction = 'asc';
            }

            filteredData.sort((a, b) => {
                let valueA = a[column] || '';
                let valueB = b[column] || '';

                if (column === 'Year' || column === 'Citation') {
                    valueA = parseInt(valueA) || 0;
                    valueB = parseInt(valueB) || 0;
                } else {
                    valueA = valueA.toString().toLowerCase();
                    valueB = valueB.toString().toLowerCase();
                }

                let comparison = 0;
                if (valueA > valueB) {
                    comparison = 1;
                } else if (valueA < valueB) {
                    comparison = -1;
                }

                return currentSort.direction === 'desc' ? comparison * -1 : comparison;
            });

            displayedRows = 50;
            updateTable();
        }

        // Apply all filters
        function applyFilters() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const filterMappings = [
                { column: 'Database', filterId: 'databaseFilter' },
                { column: 'Code Full Paper', filterId: 'codefullpaperFilter' },
                { column: 'Year', filterId: 'yearFilter' },
                { column: 'Application Domains', filterId: 'applicationdomainsFilter' },
                { column: 'Contribution Types', filterId: 'contributiontypesFilter' },
                { column: 'AI Roles', filterId: 'airolesFilter' },
                { column: 'Human Roles', filterId: 'humanrolesFilter' },
                { column: 'Human Influence', filterId: 'humaninfluenceFilter' },
                { column: 'AI Influence', filterId: 'aiinfluenceFilter' },
                { column: 'Decision Types', filterId: 'decisiontypesFilter' },
                { column: 'Modality', filterId: 'modalityFilter' }
            ];

            filteredData = papersData.filter(paper => {
                // Search filter
                if (searchTerm) {
                    const searchFields = [paper.Title, paper.Abstract, paper.Authors, paper.id].join(' ').toLowerCase();
                    if (!searchFields.includes(searchTerm)) return false;
                }

                // Citation range filter
                if (paper.Citation < citationRange.min || paper.Citation > citationRange.max) {
                    return false;
                }

                // Tag-based multi-select filters
                for (const { column, filterId } of filterMappings) {
                    const container = document.getElementById(filterId);
                    if (!container) {
                        console.warn(`Filter element ${filterId} not found`);
                        continue;
                    }

                    const selectedTags = Array.from(container.querySelectorAll('.filter-tag.selected'));
                    if (selectedTags.length > 0) {
                        const selectedValues = selectedTags.map(tag => tag.dataset.value);

                        if (paper[column]) {
                            const paperValues = paper[column].split(',')
                                .map(v => v.trim())
                                .filter(v => v && v !== '');

                            // For Database column, use case-insensitive comparison
                            // For other columns, use exact match
                            let hasMatch;
                            if (column === 'Database') {
                                const selectedLower = selectedValues.map(v => v.toLowerCase().trim());
                                const paperLower = paperValues.map(v => v.toLowerCase().trim());
                                hasMatch = selectedLower.some(value => paperLower.includes(value));
                            } else {
                                hasMatch = selectedValues.some(value => paperValues.includes(value));
                            }

                            if (!hasMatch) return false;
                        } else {
                            // If paper has no value in this column but the user selected tags, exclude it
                            return false;
                        }
                    }
                }

                return true;
            });

            if (currentSort.column) {
                sortData(currentSort.column);
            } else {
                displayedRows = 50;
                updateTable();
                updateScatterplot();
            }
        }

        // Get color for a paper based on current color mode
        function getColor(paper) {
            if (currentColorMode === 'cluster') {
                return clusterColors[paper.cluster - 1] || '#666';
            } else if (currentColorMode === 'fullpaper') {
                const fullPaper = (paper['full paper'] || '').toLowerCase();
                return fullPaperColors[fullPaper] || '#999';
            } else if (currentColorMode === 'citation') {
                const maxCitations = Math.max(...papersData.map(p => p.Citation));
                const colorScale = d3.scaleSequential(d3.interpolateBlues)
                    .domain([0, Math.log(maxCitations + 1)]);
                return colorScale(Math.log(paper.Citation + 1));
            }
            return '#666';
        }

        // Create scatterplot
        function createScatterplot() {
            const container = document.getElementById('scatterplot');
            const margin = { top: 20, right: 20, bottom: 20, left: 20 };
            const width = container.clientWidth - margin.left - margin.right;
            const height = container.clientHeight - margin.top - margin.bottom;

            d3.select('#scatterplot').selectAll('*').remove();

            const svg = d3.select('#scatterplot')
                .append('svg')
                .attr('width', width + margin.left + margin.right)
                .attr('height', height + margin.top + margin.bottom);

            const g = svg.append('g')
                .attr('transform', `translate(${margin.left},${margin.top})`);

            const papersWithEmbeddings = papersData.filter(p =>
                !isNaN(p.tsne_x) && !isNaN(p.tsne_y)
            );

            if (papersWithEmbeddings.length === 0) {
                g.append('text')
                    .attr('x', width / 2)
                    .attr('y', height / 2)
                    .attr('text-anchor', 'middle')
                    .text('No embedding data available');
                return;
            }

            const xScale = d3.scaleLinear()
                .domain(d3.extent(papersWithEmbeddings, d => d.tsne_x))
                .range([0, width]);

            const yScale = d3.scaleLinear()
                .domain(d3.extent(papersWithEmbeddings, d => d.tsne_y))
                .range([height, 0]);

            const tooltip = d3.select('#tooltip');

            const dots = g.selectAll('.dot')
                .data(papersWithEmbeddings)
                .enter().append('circle')
                .attr('class', 'dot')
                .attr('cx', d => xScale(d.tsne_x))
                .attr('cy', d => yScale(d.tsne_y))
                .attr('r', 5)
                .attr('fill', d => getColor(d))
                .attr('opacity', 0.7)
                .style('cursor', 'pointer')
                .on('mouseover', function (event, d) {
                    const tooltipContent = currentColorMode === 'cluster'
                        ? `<strong>${d.Title || 'Untitled'}</strong><br>Cluster: ${d.cluster}<br>Database: ${getCapitalizedDatabaseName(d.Database) || 'Unknown'}`
                        : currentColorMode === 'fullpaper'
                        ? `<strong>${d.Title || 'Untitled'}</strong><br>Full-text: ${d['full paper'] || 'Unknown'}<br>Database: ${getCapitalizedDatabaseName(d.Database) || 'Unknown'}`
                        : `<strong>${d.Title || 'Untitled'}</strong><br>Citation: ${d.Citation}<br>Database: ${getCapitalizedDatabaseName(d.Database) || 'Unknown'}`;

                    d3.select(this)
                        .attr('stroke', '#000')
                        .attr('stroke-width', 2);

                    tooltip.style('opacity', 1)
                        .html(tooltipContent)
                        .style('left', (event.pageX + 10) + 'px')
                        .style('top', (event.pageY + 10) + 'px');
                })
                .on('mouseout', function () {
                    tooltip.style('opacity', 0);

                    d3.select(this)
                        .attr('stroke', 'none')
                        .attr('stroke-width', 0);
                })
                .on('click', function (event, d) {
                    highlightPaper(d.id);
                });

            updateLegend();

            window.scatterplotElements = { svg, g, dots, xScale, yScale };
        }

        // Update scatterplot colors
        function updateScatterplotColors() {
            if (!window.scatterplotElements) return;

            const { dots } = window.scatterplotElements;

            dots.transition()
                .duration(500)
                .attr('fill', d => getColor(d));
        }

        // Create/Update legend based on color mode
        function updateLegend() {
            const legend = document.getElementById('legend');
            legend.innerHTML = '';

            if (currentColorMode === 'cluster') {
                for (let i = 1; i < 5; i++) {
                    const item = document.createElement('div');
                    item.className = 'legend-item';

                    const color = document.createElement('div');
                    color.className = 'legend-color';
                    color.style.backgroundColor = clusterColors[i - 1];

                    const label = document.createElement('span');
                    label.textContent = `Cluster ${i}`;

                    item.appendChild(color);
                    item.appendChild(label);
                    legend.appendChild(item);
                }
            } else if (currentColorMode === 'fullpaper') {
                ['yes', 'no'].forEach(value => {
                    const item = document.createElement('div');
                    item.className = 'legend-item';

                    const color = document.createElement('div');
                    color.className = 'legend-color';
                    color.style.backgroundColor = fullPaperColors[value];

                    const label = document.createElement('span');
                    label.textContent = `Full-text: ${value}`;

                    item.appendChild(color);
                    item.appendChild(label);
                    legend.appendChild(item);
                });
            } else if (currentColorMode === 'citation') {
                const maxCitations = Math.max(...papersData.map(p => p.Citation));
                const steps = [0, 10, 100, 1000];

                const colorScale = d3.scaleSequential(d3.interpolateBlues)
                    .domain([0, Math.log(maxCitations + 1)]);

                steps.forEach(step => {
                    const item = document.createElement('div');
                    item.className = 'legend-item';

                    const color = document.createElement('div');
                    color.className = 'legend-color';
                    color.style.backgroundColor = colorScale(Math.log(step + 1));

                    const label = document.createElement('span');
                    label.textContent = `${step} citation`;

                    item.appendChild(color);
                    item.appendChild(label);
                    legend.appendChild(item);
                });
            }
        }

        // Update scatterplot based on filters
        function updateScatterplot() {
            if (!window.scatterplotElements) return;

            const { dots } = window.scatterplotElements;
            const filteredIds = new Set(filteredData.map(p => p.id));

            dots.transition()
                .duration(300)
                .attr('opacity', d => filteredIds.has(d.id) ? 0.7 : 0.1)
                .attr('r', d => filteredIds.has(d.id) ? 5 : 2);
        }

        // Update table
        function updateTable(newlyAddedColumn = null) {
            const tableHead = document.getElementById('tableHead');
            const tableBody = document.getElementById('tableBody');
            const tableStats = document.getElementById('tableStats');
            const showMoreBtn = document.getElementById('showMoreBtn');
            const tableContainer = document.querySelector('.table-container');

            tableStats.textContent = `Showing ${Math.min(displayedRows, filteredData.length)} of ${filteredData.length} papers`;

            showMoreBtn.style.display = displayedRows >= filteredData.length ? 'none' : 'block';

            tableHead.innerHTML = '';
            const headerRow = document.createElement('tr');

            // Columns that should display as labels
            const labelColumns = [
                'Human Influence', 'AI Influence', 'Decision Types',
                'AI Roles', 'Human Roles', 'Application Domains',
                'Contribution Types', 'Modality'
            ];

            visibleColumns.forEach(column => {
                const th = document.createElement('th');
                th.textContent = column;
                th.className = 'sortable';
                th.id = `th_${column}`; // Add ID for easy lookup

                // Apply same column classes as data cells for consistent widths
                if (column === 'ID') {
                    th.classList.add('id-cell');
                } else if (column === 'Title') {
                    th.classList.add('title-cell');
                } else if (column === 'Abstract') {
                    th.classList.add('abstract-cell');
                } else if (column === 'Year') {
                    th.classList.add('year-cell');
                } else if (column === 'Authors') {
                    th.classList.add('authors-cell');
                } else if (column === 'Link') {
                    th.classList.add('link-cell');
                } else if (column === 'Citation') {
                    th.classList.add('citation-cell');
                } else if (labelColumns.includes(column)) {
                    th.classList.add('table-label-cell');
                }

                if (currentSort.column === column) {
                    th.classList.add(currentSort.direction === 'asc' ? 'sort-asc' : 'sort-desc');
                }

                th.addEventListener('click', () => sortData(column));
                headerRow.appendChild(th);
            });
            tableHead.appendChild(headerRow);

            tableBody.innerHTML = '';
            const displayData = filteredData.slice(0, displayedRows);

            displayData.forEach(paper => {
                const row = document.createElement('tr');
                row.dataset.paperId = paper.id;
                row.style.cursor = 'pointer';

                row.addEventListener('click', () => {
                    highlightPaper(paper.id);
                });

                visibleColumns.forEach(column => {
                    const td = document.createElement('td');
                    let value = paper[column] || '';

                    // Columns that should display as labels
                    const labelColumns = [
                        'Human Influence', 'AI Influence', 'Decision Types',
                        'AI Roles', 'Human Roles', 'Application Domains',
                        'Contribution Types', 'Modality'
                    ];

                    if (column === 'ID') {
                        value = paper.id;
                        td.className = 'id-cell';
                        td.textContent = value;
                    } else if (column === 'Title') {
                        td.className = 'title-cell';
                        td.textContent = value;
                    } else if (column === 'Abstract') {
                        td.className = 'abstract-cell';
                        // value = value.substring(0, 200) + (value.length > 200 ? '...' : '');
                        // td.textContent = value;
                        const wrapper = document.createElement('div');
                        wrapper.className = 'abstract-wrapper';
                        wrapper.textContent = value;
                        td.appendChild(wrapper);
                    } else if (column === 'Link' && value) {
                        td.innerHTML = `<a href="${value}" target="_blank" class="link-icon" title="Open link">
                            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path>
                                <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
                            </svg>
                        </a>`;
                    } else if (column === 'Year') {
                        value = value || 'N/A';
                        td.className = 'year-cell';
                        td.textContent = value;
                    } else if (column === 'Authors') {
                        td.className = 'authors-cell';
                        const wrapper = document.createElement('div');
                        wrapper.className = 'authors-wrapper';
                        wrapper.textContent = value;
                        td.appendChild(wrapper);
                    } else if (column === 'Citation') {
                        value = paper[column] !== undefined && paper[column] !== null ? paper[column] : '0';
                        td.textContent = value;
                    } else if (column === 'Bibtex') {
                        td.className = 'bibtex-cell';
                        td.textContent = value;
                    } else if (labelColumns.includes(column)) {
                        // Display as labels
                        td.className = 'table-label-cell';
                        if (value) {
                            const values = value.split(',')
                                .map(v => v.trim())
                                .filter(v => v && v !== '' && v !== 'NA');

                            if (values.length > 0) {
                                values.forEach(val => {
                                    const label = document.createElement('span');
                                    label.className = 'table-label';
                                    label.textContent = val;
                                    td.appendChild(label);
                                });
                            } else {
                                td.textContent = '';
                            }
                        } else {
                            td.textContent = '';
                        }
                    } else if (column === 'Modality' || column === 'AI Input' || column === 'Human Input') {
                        td.className = 'lowercase-cell';
                        td.textContent = value;
                    } else {
                        td.textContent = value;
                    }

                    row.appendChild(td);
                });

                tableBody.appendChild(row);
            });

            // Scroll to newly added column if specified
            if (newlyAddedColumn && tableContainer) {
                // Use setTimeout to ensure DOM is fully rendered
                setTimeout(() => {
                    const columnHeader = document.getElementById(`th_${newlyAddedColumn}`);
                    if (columnHeader) {
                        const containerRect = tableContainer.getBoundingClientRect();
                        const headerRect = columnHeader.getBoundingClientRect();
                        const targetLeft = tableContainer.scrollLeft + (headerRect.left - containerRect.left) - 20; // small padding
                        tableContainer.scrollTo({
                            left: Math.max(0, targetLeft),
                            behavior: 'smooth'
                        });
                    }
                }, 50);
            }
        }

        // Highlight paper in both scatterplot and table
        function highlightPaper(paperId) {
            document.querySelectorAll('.highlighted-row').forEach(row => {
                row.classList.remove('highlighted-row');
            });

            if (window.scatterplotElements) {
                const { dots } = window.scatterplotElements;
                dots.classed('highlighted-dot', false);
            }

            const tableRow = document.querySelector(`tr[data-paper-id="${paperId}"]`);
            if (tableRow) {
                tableRow.classList.add('highlighted-row');
                tableRow.scrollIntoView({ behavior: 'smooth', block: 'center' });
            }

            if (window.scatterplotElements) {
                const { dots } = window.scatterplotElements;
                dots.classed('highlighted-dot', d => d.id === paperId);
            }

            currentHighlightedId = paperId;
        }

        // Handle window resize
        window.addEventListener('resize', () => {
            setTimeout(() => {
                createScatterplot();
                updateScatterplot();
            }, 100);
        });

        // BibTeX copy functionality
        function setupBibtexCopy() {
            const bibtexBtn = document.getElementById('bibtexCopyBtn');
            if (bibtexBtn) {
                bibtexBtn.addEventListener('click', async (e) => {
                    e.preventDefault();
                    
                    const bibtexEntry = `@article{bai2025shadow,
                                            title={In the Shadow of Judgment: Mapping Out the Landscape of Human--AI Decision-Making Through a Systematic Review},
                                            author={Bai, Yixin and Yang, Taehyun and Xu, Zhongzheng and Ki, Dayeon and Wang, Ziyi and Hou, Yu and Yang, Fumeng},
                                            journal={Unpublished manuscript},
                                            year={2026},
                                            doi={}
                                            }`;

                    try {
                        await navigator.clipboard.writeText(bibtexEntry);
                        const originalText = bibtexBtn.textContent;
                        bibtexBtn.textContent = 'Copied!';
                        bibtexBtn.style.background = '#2f6fb7';
                        setTimeout(() => {
                            bibtexBtn.textContent = originalText;
                            bibtexBtn.style.background = '';
                        }, 2000);
                    } catch (err) {
                        // Fallback for older browsers
                        const textArea = document.createElement('textarea');
                        textArea.value = bibtexEntry;
                        textArea.style.position = 'fixed';
                        textArea.style.opacity = '0';
                        document.body.appendChild(textArea);
                        textArea.select();
                        try {
                            document.execCommand('copy');
                            const originalText = bibtexBtn.textContent;
                            bibtexBtn.textContent = 'Copied!';
                            bibtexBtn.style.background = '#2f6fb7';
                            setTimeout(() => {
                                bibtexBtn.textContent = originalText;
                                bibtexBtn.style.background = '';
                            }, 2000);
                        } catch (fallbackErr) {
                            alert('Failed to copy BibTeX. Please copy manually.');
                        }
                        document.body.removeChild(textArea);
                    }
                });
            }
        }

        // Initialize when page loads
        document.addEventListener('DOMContentLoaded', () => {
            init();
            setupBibtexCopy();
        });
    </script>
</body>

</html>